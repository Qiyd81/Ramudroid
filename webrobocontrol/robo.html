<html>
	
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<title> Web Controled Robot </title>
		
	<script type="text/javascript" src="jquery.min.js" ></script>
	<script type="text/javascript" src="js/bootstrap.js"></script>
	<script type="text/javascript" src="js/bootbox.min.js"></script>
	<script type="text/javascript" src="js/spin.min.js"></script>

	<link rel="stylesheet" href="css/cerulean/bootstrap.css" type="text/css"/>
	<link rel="stylesheet" href="css/demo.css" type="text/css"/>
	    
</head>

<body>
			
	<script>

		function clearotherbuttons(selectedbutton){
	        for (var i = 1; i <=5; i++) {
           		if(("btn"+i)!= selectedbutton)
           		if(document.getElementById("btn"+i).getAttribute('content')=="on" ) toggleState(document.getElementById("btn"+i));
			}
		}

		function toggleState(item){
           if(item.className == "button on") {
              item.className="button off";
              item.setAttribute('content', 'off');

           } else {
              item.className="button on";
              item.setAttribute('content', 'on');
           }
           				
        }
	        
        function toggleState_1(item){
           if(item.className == "button on_1") {
              item.className="button off_1";
              item.setAttribute('content', 'off');
              item.value = 'off';
           } else {
              item.className="button on_1";
              item.setAttribute('content', 'on');
              item.value = 'on';
           }
        }

		//var rpi_ip= prompt("Please enter Rpi IP  ", "");
		var rpi_ip="127.0.0.1:5559";
		var rpi_streaming_ip = "http://127.0.0.1:8081/stream/video.mjpeg";
		var rpi_streaming_config_list = "http://127.0.0.1:8080/0/config/list";

		var pin1 = "0";
		var pin2 = "0";
		var pin3 = "0";
		var pin4 = "0";
		var pin5 = "0";
		var pin6 = "0";
		var pin7 = "0";
		var pin8 = "0";
			       
		function func1(move_var){  
			    
			 if(move_var=="top"){
			 	console.log(" top");
			 	pin1="1";
			 	pin2="0";
			 	pin3="1";
			 	pin4="0";
			 	pin5="0";
			 	pin6="0";
			 	pin7="0";
			 	pin8="0";
			 }
			 else if(move_var=="right"){
			 	console.log(" right");
			 	pin1="1";
			 	pin2="0";
			 	pin3="0";
			 	pin4="0";
			 	pin5="0";
			 	pin6="0";
			 	pin7="0";
			 	pin8="0";
			 }
			 else if(move_var=="left"){
			 	console.log(" left");
			 	pin1="0";
			 	pin2="0";
			 	pin3="1";
			 	pin4="0";
			 	pin5="0";
			 	pin6="0";
			 	pin7="0";
			 	pin8="0";
			 }
			 else if(move_var=="back"){
			 	console.log(" back");
			 	pin1="0";
			 	pin2="1";
			 	pin3="0";
			 	pin4="1";
			 	pin5="0";
			 	pin6="0";
			 	pin7="0";
			 	pin8="0";
			 }
			 else if(move_var=="stop"){
			 	console.log(" stop");
			 	pin1="0";
			 	pin2="0";
			 	pin3="0";
			 	pin4="0";
			 	pin5="0";
			 	pin6="0";
			 	pin7="0";
			 	pin8="0";
			 }
			 else if(move_var=="clean"){
			 	console.log(" clean");
			 	
				//get status of top
				if(document.getElementById('btn1').getAttribute('content')=="on"){
			 		pin1="1";
			 		pin2="0";
			 		pin3="1";
			 		pin4="0";
			 	}
			 	
			 	//get status of left
			 	else if(document.getElementById('btn2').getAttribute('content')=="on"){
			 		pin1="0";
			 		pin2="0";
			 		pin3="1";
			 		pin4="0";
			 	}
			 	
			 	//get status of stop
			 	else if(document.getElementById('btn3').getAttribute('content')=="on"){
			 		pin1="0";
			 		pin2="0";
			 		pin3="0";
			 		pin4="0";
			 	}
			 	
			 				 	
			 	//get sttaus of right
			 	else if(document.getElementById('btn4').getAttribute('content')=="on"){
			 		pin1="1";
			 		pin2="0";
			 		pin3="0";
			 		pin4="0";
			 	}
			 	
			 	
			 	//get sttaus of back
			 	else if(document.getElementById('btn4').getAttribute('content')=="on"){
			 		pin1="0";
			 		pin2="1";
			 		pin3="0";
			 		pin4="1";
			 	}
			 	
			 	//default case of stop
			 	else{
			 		pin1="0";
			 		pin2="0";
			 		pin3="0";
			 		pin4="0";
			 	}
			 	
			 	//get the value of button from seeting clean button numb 7
			 	if(document.getElementById('btn6').getAttribute('content')=="on"){
			 		pin5="1";
			 	}
			 	else{
			 		pin5="0";
			 	}

			 	pin6="0";
			 	pin7="0";
			 	pin8="0";
			 }
			 else if(move_var=="lift"){
			 	console.log(" lift");
			 	
			 	pin1="0";
			 	pin2="0";
			 	pin3="0";
			 	pin4="0";
			 	pin5="0";
			 	
			 	//clear the clean switch ,if on
			 	if ( document.getElementById('btn6').getAttribute('content')=="on"){
			 		toggleState_1(document.getElementById('btn6'));
			 	}
			 	
			 	if(document.getElementById('btn7').getAttribute('content')=="on"){
			 		pin6="1";
			 		pin7="0";
			 	}
			 	else{
			 		pin6="0";
			 		pin7="1";
			 	}
			 	pin8="0";
			 }
			 else{
			 //even if it doesnt match anything , just stop 
			    console.log(" stop");
				pin1="0";
			 	pin2="0";
			 	pin3="0";
			 	pin4="0";
			 	pin5="0";
			 	pin6="0";
			 	pin7="0";
			 	pin8="0";
			 }
			document.getElementById('myFrame19').src=
				"http://"+rpi_ip+"/m2m/rpiramudroid/perform1.php?p1=" + pin1 + "&p2=" + pin2 + "&p3=" + pin3+ "&p4=" + pin4+ "&p5=" + pin5+ "&p6=" + pin6+ "&p7=" + pin7+ "&p8=" + pin8;    
		}
	</script>

	<div class="tabContainer">

	<!--
	<canvas id="rpiCanvas" style="width:100%" ></canvas>
	-->

	<div class="container">
	
		<div class="row">
			<img id="streamFrame" src="" />
		</div>


		<div class="container ButtonsClass">

			<div class="row mediaControlBar">
				<input type="button" id="btn2" value="Left" content="off" class="button off" />
				<input type="button" id="btn3" value="Stop" content="off" class="button off" />
				<input type="button" id="btn4" value="Right" content="off" class="button off"/>
			</div>

			<div class="row controlBar">
				<table id="controls" class="panel-controlbuttons">
					<tr>
						<td></td>
						<td><input type="button" id="btn1" value="Top" content="off" class="button off" onclick="toggleState(this);clearotherbuttons('btn1');func1('top');" /></td>
						<td></td>
					</tr>
					
					<tr>
						<td><input type="button" id="btn2" value="Left" content="off" class="button off" onclick="toggleState(this);clearotherbuttons('btn2');func1('left');" /></td>
						<td><input type="button" id="btn3" value="Stop" content="off" class="button off" onclick="toggleState(this);clearotherbuttons('btn3');func1('stop');" /></td>
						<td><input type="button" id="btn4" value="Right" content="off" class="button off" onclick="toggleState(this);clearotherbuttons('btn4');func1('right');" /></td>
					</tr>

					<tr>
						<td></td>
						<td><input type="button" id="btn5" value="Back" content="off" class="button off" onclick="toggleState(this);clearotherbuttons('btn5');func1('back');" /></td>
						<td></td>				
					</tr>

					<tr style="height: 80;">
						<td>Clean : <input type="button" id="btn6" value="off" content="off" class="button off_1" onclick="toggleState_1(this);func1('clean');" /> </td>
						<td>Lift Garbage : <input type="button" id="btn7" value="off" content="off" class="button off_1" onclick="toggleState_1(this);func1('lift');" /></td>
						<td></td>
					</tr>
				</table>
			</div>

			<div class="row bottomBar">
			    <div class="col-xs-6 col-sm-3">
			    	<iframe id="myFrame19" src="#" width="80%" height="60" frameborder="1" style="align:centre"></iframe>
			    </div>
			    <div class="col-xs-6 col-sm-3">
			    	<iframe id="myFrame20" src="#" width="80%" height="60" frameborder="1" style="align:centre;margin-bottom: 40px;"></iframe>	
			    </div>
			    <div class="col-xs-6 col-sm-3">
			    	<iframe id="motionConfFrame" src="#"></iframe>
			    </div>
			    <div class="col-xs-6 col-sm-3">

			    </div>
			</div>

			<div class="row rightSideBar">
			    <div class="col-xs-6 col-sm-3">
			    	
			    </div>
			    <div class="col-xs-6 col-sm-3">
			    	
			    </div>
			    <div class="col-xs-6 col-sm-3">

			    </div>
			    <div class="col-xs-6 col-sm-3">
			    	<div id="detectMotion"></div>
			    	<input type="button" id="detecMotionButton" value="no status"/>
			    </div>
			</div>

		</div>

	</div>

	<div class="footer">
		<p> Altanai and Deepak Aagri- || 2015</p>
	</div>
			
<script>

	function updateStatus(){
		$("#detecMotionButton").html(result);
	}

	$("#detecMotionButton").click(function(){

		/*	    
		var pm_url = 'http://127.0.0.1:8080/0/detection/status';
	    var photos = function (data) {
	     alert(data);
	    };
	    $.ajax({
	        url: pm_url,
	        dataType: 'jsonp',
	        jsonpCallback: 'photos',
	        jsonp: true,
	    });*/

		$.ajax({url: "http://127.0.0.1:8080/0/detection/status", 
        	success: function(result){
        	    $("#detecMotionButton").html(result);
        	}
    	});
		/*
		$.ajax({
		    url: "http://127.0.0.1:8080/0/detection/status",
		    jsonp: "updateStatus",
		    dataType: "jsonp",
		    data: {
		        q: "select title,abstract,url from search.news where query=\"cat\"",
		        format: "json"
		    },
		 
		    // Work with the response
		    success: function( response ) {
		        console.log( response ); // server response

		    }
		});*/

    });

	document.getElementById('myFrame19').src= "http://"+rpi_ip+"/m2m/rpiramudroid/perform1.php?p1=" + 0 + 
	"&p2=" + 0 +"&p3=" + 0+ "&p4=" + 0+ "&p5=" + 0+ "&p6=" + 0+ "&p7=" + 0+ "&p8=" + 0;
	
	document.getElementById("streamFrame").src= rpi_streaming_ip;
	document.getElementById("streamFrame").height= window.innerHeight;
	//document.getElementById("streamFrame").width= 90/100*window.innerHeight;

	document.getElementById("motionConfFrame").src=rpi_streaming_config_list;

	function refreshCanvas(){
		var canvas = document.getElementById('rpiCanvas');
	  	var ctx =canvas.getContext("2d");
	  	var imgStream=document.getElementById("streamFrame");
		ctx.drawImage(imgStream, 0, 0);
  	}

	//document.getElementById('myFrame18').src="http://"+rpi_ip+":8081";
	var streamFrame=document.getElementById("streamFrame");
	streamFrame.onload = function() { 
      	//window.setInterval("refreshCanvas()", 10);
	}; 

	document.getElementById('myFrame20').src="http://"+rpi_ip+"/m2m/rpiramudroid/perform2.php?&p8=" + 0;

/*
if(document.getElementById('myFrame18').contentWindow.getElementsByTagName("img")!=undefined){

	var imgStream= document.getElementById('myFrame18').contentWindow.getElementsByTagName("img")[0];

  	function drawStuff() {

  	  var canvas = document.getElementById('rpiCanvas');
	  var ctx =canvas.getContext("2d");
	  var v = '';

      DEBUG && console.log(" drawing stream mpeg img  on canvas ");
      clearInterval(i);
      paintCanvas(imgStream , ctx, "500px" , "500px");

  	}

  function paintCanvas(v,c,w,h) {
    c.clearRect(0, 0, w, h);
    i=window.setInterval(function() {
           c.drawImage(v,0,0,w,h)
         },20);
  }

}*/

</script>	
			
				
</body>

</html>